import React from 'react';
import classNames from 'classnames';

import useFetch from 'hooks/useFetch';


const Favorite = ({isFavorited, favoritesCount, slug}) => {
    const apiUrl = `/articles/${slug}/favorite`;
    const [{response}, handlerFetch] = useFetch(apiUrl);
    const favoritesCountResponse = response ? response.article.favoritesCount : favoritesCount;
    const isFavoritedResponse = response ? response.article.favorited : isFavorited;
    const buttonClasses = classNames({
        btn: true,
        'btn-sm': true,
        'btn-primary': isFavoritedResponse,
        'btn-outline-primary': !isFavoritedResponse
    });

    const handleLike = event => {
        event.preventDefault();
        handlerFetch({
            method: isFavoritedResponse ? 'delete' : 'post'
        })
    };

    return (
        <button
            className={buttonClasses}
            onClick={handleLike}>
            <i className="ion-heart"></i>
            <span>{favoritesCountResponse}</span>
        </button>
    );
};

export default Favorite;